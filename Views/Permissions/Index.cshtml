@using IndustrialContoroler.ViewModel
@using static IndustrialContoroler.Models.Helper
@inject IHttpContextAccessor _sessions
@model PermissionVM




<div class="card mb-4 ms-3 me-3">
    <h3 style="font-family: 'Almarai', sans-serif; font-size:20px;  background-color: rgb(82, 134, 203); color: azure;" class=" card-header py-3 mb-10 "><img class="me-3" src="~/img/report25.png" alt="">@ResourceWeb.lbManagePermission (@Model.RoleName) </h3>


    <div class="card">
        <div id="viewAll" class="card-body table-responsive">
            <form style="font-family: 'Cairo', sans-serif; font-size:14px;" asp-controller="permissions" method="post" asp-action="Update" class="d-inline">
                <input asp-for="@Model.RoleId" type="hidden" />
                <table class="table table-striped" id="permissionTable">
                    <thead style="font-family: 'Almarai', sans-serif; font-size:16px;" id="tablePermission">
                        <tr>

                            <th style="font-family: 'Almarai', sans-serif; font-size:16px;" class="text-nowrap">
                                اسم الصلاحية
                                <i class="bx bx-info-circle bx-xs"
                                   data-bs-toggle="tooltip"
                                   data-bs-placement="top"
                                   title="اختار اسم الصلاحية مع العملسة المناسبة"></i>
                            </th>
                            <th style="font-family: 'Almarai', sans-serif; font-size:16px;">
                                العمليات
                            </th>

                            @*<td>
                            <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="selectAll" />
                            <label class="form-check-label" for="selectAll"> تحديد الكل  </label>
                            </div>
                            </td>*@

                        </tr>

                    </thead>
                    <tbody style="font-family: 'Cairo', sans-serif; font-size:14px;">
                        @foreach (var item in Enum.GetValues(typeof(PermissionModuleName)))
                        {
                            <tr>

                                @switch (@item.ToString())
                                {
                                    case "Home":
                                        <td>الصفحة الرئسية </td>
                                        break;
                                    case "CreateFacility":
                                        <td> بيانات المنشأة </td>
                                        break;
                                    case "Request":
                                        <td> الطلبات </td>

                                        break;
                                    case "FieldVisitForms":
                                        <td> استمارات الزيارات الميدانية </td>
                                        break;
                                    case "Search":

                                        <td> البحث والاستعلام</td>
                                        break;  
                                    case "Reports":
                                        <td> التقارير</td>
                                        break;
                                    case "Charts":
                                        <td> رسوم بيانية</td>
                                        break;
                                        
                                     case "Statistics":
                                        <td> إحصائيات</td>
                                        break;
                                      case "Notification":
                                        <td> الإشعارات</td>
                                        break;
                                     case "Maps":
                                        <td> خرائط</td>
                                        break;

                                    case "Account":
                                        <td> لإدارة المستخدمين</td>
                                        break;
                                    case "Roles":
                                        <td>ادارة الصلاحيات </td>
                                        break;
                                    case "WorkFlowRequest":
                                        <td>سير العمليات</td>
                                        break;
                                    


                                    default:
                                        break;
                                }
                                @for (int i = 0; i < Model.RoleClaims.Count(); i++)
                                {
                                    if (@Model.RoleClaims[i].Value.Split('.')[1] == item.ToString())
                                    {
                                        <td>
                                            <input asp-for="@Model.RoleClaims[i].Value" type="hidden" />
                                            @Model.RoleClaims[i].Value.Split('.')[2]
                                        </td>
                                        <td>
                                            <div class="form-check m-1">
                                                <input asp-for="@Model.RoleClaims[i].Selected" class="form-check-input" />
                                            </div>
                                        </td>
                                    }
                                }
                            </tr>

                        }
                    </tbody>
                </table>

                <div class="col border-end  d-flex justify-content-center align-items-center p-3">
                    <button class="btn btn-primary  " type="submit" id="save">
                        <span style="font-family: 'Almarai', sans-serif; font-size:18px;" class="d-flex justify-content-center align-items-center text-nowrap"><i class="fa fa-check p-1"></i>     حفظ    </span>
                    </button>
                </div>



            </form>
        </div>
    </div>

</div>
@section Scripts{
    @if (!string.IsNullOrEmpty(_sessions.HttpContext.Session.GetString(Helper.MsgType)))
    {
        if (_sessions.HttpContext.Session.GetString(Helper.MsgType) == Helper.Success)
        {
            <script>

                Swal.fire({
                    title: '@_sessions.HttpContext.Session.GetString(Helper.Title)',
                    text: '@Html.Raw(@_sessions.HttpContext.Session.GetString(Helper.Msg))',
                    confirmButtonText: '@ResourceWeb.lbOk',
                    icon: 'success'
                });
            </script>

        }
        else
        {
            <script>

                Swal.fire({
                    title: '@_sessions.HttpContext.Session.GetString(Helper.Title)',
                    text: '@Html.Raw(@_sessions.HttpContext.Session.GetString(Helper.Msg))',
                    confirmButtonText: '@ResourceWeb.lbOk',
                    icon: 'error'
                });
            </script>
        }
        _sessions.HttpContext.Session.SetString(Helper.MsgType, "");
    }

    <script src="~/Modules/Registers.js"></script>



    <script>

        let lbTitleEdit = '@Html.Raw(ResourceWeb.lbTitleEdit)';
        let lbEdit = '@Html.Raw(ResourceWeb.lbEdit)';
        let lbAddNewRole = '@Html.Raw(ResourceWeb.lbAddNewRole)';
        let lbbtnSave = '@Html.Raw(ResourceWeb.lbbtnSave)';

        let lbTitleMsgDelete = '@Html.Raw(ResourceWeb.lbbtnSave)';
        let lbTextMsgDelete = '@Html.Raw(ResourceWeb.lbTextMsgDelete)';
        let lbconfirmButtonText = '@Html.Raw(ResourceWeb.lbconfirmButtonText)';
        let lbcancelButtonText = '@Html.Raw(ResourceWeb.lbcancelButtonText)';

        let lbTitleDeletedOk = '@Html.Raw(ResourceWeb.lbTitleDeletedOk)';
        let lbMsgDeletedOkRegister = '@Html.Raw(ResourceWeb.lbMsgDeletedOkRegister)';
        let lbSuccess = '@Html.Raw(Helper.Success)';
        let PathImageuser = '@Html.Raw(Helper.PathImageuser)';



    </script>
        }